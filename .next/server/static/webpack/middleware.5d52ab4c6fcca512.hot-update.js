"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.ts":
/*!***********************!*\
  !*** ./middleware.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n\n// Define public routes that don't require authentication\nconst publicRoutes = [\n    '/landing',\n    '/faqs',\n    '/signin',\n    '/signup',\n    '/onboarding/step-1',\n    '/onboarding/step-2',\n    '/onboarding/step-3',\n    '/onboarding/step-4',\n    '/onboarding/step-5',\n    '/onboarding/step-6',\n    'policy-page',\n    '/about',\n    '/help',\n    '/verifyEmail',\n    '/forgot-password',\n    '/logout',\n    '/careers'\n];\n// Define protected routes that require authentication\nconst protectedRoutes = [\n    '/payment/planSelection',\n    '/payment/cardDetails',\n    '/payment/success',\n    '/payment/methodSlection',\n    '/payment/currencySelection',\n    '/dashboard',\n    '/admin/dashboard'\n];\nfunction middleware(request) {\n    const url = request.nextUrl.clone();\n    const { pathname } = url;\n    // Get the tokens from cookies and headers\n    const authCookie = request.cookies.get('authorization')?.value;\n    const tokenCookie = request.cookies.get('token')?.value;\n    const authHeader = request.headers.get('authorization');\n    const token = tokenCookie || (authHeader?.startsWith('Bearer ') ? authHeader.split(' ')[1] : null) || (authCookie?.startsWith('Bearer ') ? authCookie.split(' ')[1] : null);\n    console.log(token);\n    // STRICT DASHBOARD LOCK - Check this FIRST, before ANY other checks\n    if (request.cookies.get('dashboardLock')?.value === 'true') {\n        // Only allow dashboard and logout, block EVERYTHING else\n        if (pathname !== '/dashboard' && pathname !== '/logout') {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/dashboard', request.url));\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // Check if the route is public\n    const isPublicRoute = publicRoutes.some((route)=>pathname === route || pathname.startsWith(route + '/'));\n    // If it's a public route, allow access immediately\n    if (isPublicRoute) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // Check if the route is protected\n    const isProtectedRoute = protectedRoutes.some((route)=>pathname === route || pathname.startsWith(route + '/'));\n    // If it's a protected route and there's no token, redirect to signin\n    if (isProtectedRoute && !token) {\n        const url = new URL('/signin', request.url);\n        url.searchParams.set('from', pathname);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(url);\n    }\n    // If authenticated and on dashboard, set strict lock\n    if (pathname === '/dashboard' && token) {\n        const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n        response.headers.set('Cache-Control', 'no-store, no-cache, must-revalidate, proxy-revalidate');\n        response.headers.set('Pragma', 'no-cache');\n        response.headers.set('Expires', '0');\n        response.cookies.set('dashboardLock', 'true', {\n            path: '/'\n        });\n        return response;\n    }\n    // If authenticated and on admin dashboard, set strict lock\n    if (pathname === '/admin/dashboard' && token) {\n        const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n        response.headers.set('Cache-Control', 'no-store, no-cache, must-revalidate, proxy-revalidate');\n        response.headers.set('Pragma', 'no-cache');\n        response.headers.set('Expires', '0');\n        response.cookies.set('adminDashboardLock', 'true', {\n            path: '/'\n        });\n        return response;\n    }\n    // If admin dashboard lock is set, only allow admin dashboard and logout\n    if (request.cookies.get('adminDashboardLock')?.value === 'true') {\n        if (pathname !== '/admin/dashboard' && pathname !== '/logout') {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/admin/dashboard', request.url));\n        }\n    }\n    // Handle logout\n    if (pathname === '/logout') {\n        const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/signup', request.url));\n        // Clear all cookies\n        const cookies = request.cookies.getAll();\n        cookies.forEach((cookie)=>{\n            response.cookies.delete(cookie.name);\n        });\n        // Clear specific important cookies\n        response.cookies.delete('onboardingToken');\n        response.cookies.delete('token');\n        response.cookies.delete('authorization');\n        response.cookies.delete('adminDashboardLock');\n        response.cookies.delete('dashboardLock');\n        return response;\n    }\n    // Redirect /lading to /landing (typo fix)\n    if (pathname === '/') {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/landing', request.url));\n    }\n    // Handle verification URL redirect\n    if (pathname === '/signin' && url.hash.includes('verifyEmail')) {\n        // Extract businessId and token from hash\n        const hashParts = url.hash.split('/');\n        const businessId = hashParts[hashParts.length - 1].split('?')[0];\n        const token = url.hash.split('token=')[1];\n        // Redirect to verification page\n        url.pathname = `/verifyEmail/${businessId}`;\n        url.search = `?token=${token}`;\n        url.hash = '';\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(url);\n    }\n    // Store current step in cookie when on onboarding\n    if (pathname.startsWith('/onboarding/step-')) {\n        const currentStep = pathname.split('step-')[1];\n        const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n        response.cookies.set('currentStep', currentStep || '1', {\n            path: '/'\n        });\n        response.cookies.set('inOnboarding', 'true', {\n            path: '/'\n        });\n        return response;\n    }\n    // If trying to access dashboard while on onboarding, keep them on current step\n    if (pathname === '/dashboard' && request.cookies.get('inOnboarding')?.value === 'true') {\n        const currentStep = request.cookies.get('currentStep')?.value || '1';\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(`/onboarding/step-${currentStep}`, request.url));\n    }\n    // Clear onboarding cookies when not in onboarding\n    if (!pathname.startsWith('/onboarding/')) {\n        const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n        response.cookies.delete('inOnboarding');\n        response.cookies.delete('currentStep');\n        return response;\n    }\n    // If there's a token, allow access\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n}\n// Configure which routes to run middleware on\n// export const config = {\n//   matcher: [\n//     /*\n//      * Match all request paths except for the ones starting with:\n//      * - api (API routes)\n//      * - _next/static (static files)\n//      * - _next/image (image optimization files)\n//      * - favicon.ico (favicon file)\n//      */\n//     '/((?!api|_next/static|_next/image|favicon.ico|.*\\\\.(png|jpg|jpeg|gif|webp|svg|ico|css|js)).*)',\n//   ],\n// } \nconst config = {\n    matcher: '/((?!api|_next/static|_next/image|favicon.ico|.*\\\\.(?:png|jpg|jpeg|gif|webp|svg|ico|css|js)).*)'\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQyxJQUFJQyxJQUFJLENBQUMsaUJBQWlCLEVBQUVxQixhQUFhLEVBQUV2QyxRQUFRQyxHQUFHO0lBQ3JGO0lBRUEsa0RBQWtEO0lBQ2xELElBQUksQ0FBQ0csU0FBU1MsVUFBVSxDQUFDLGlCQUFpQjtRQUN4QyxNQUFNYSxXQUFXOUIscURBQVlBLENBQUN1QixJQUFJO1FBQ2xDTyxTQUFTcEIsT0FBTyxDQUFDeUIsTUFBTSxDQUFDO1FBQ3hCTCxTQUFTcEIsT0FBTyxDQUFDeUIsTUFBTSxDQUFDO1FBQ3hCLE9BQU9MO0lBQ1Q7SUFFQSxtQ0FBbUM7SUFDbkMsT0FBTzlCLHFEQUFZQSxDQUFDdUIsSUFBSTtBQUMxQjtBQUVBLDhDQUE4QztBQUM5QywwQkFBMEI7QUFDMUIsZUFBZTtBQUNmLFNBQVM7QUFDVCxvRUFBb0U7QUFDcEUsNEJBQTRCO0FBQzVCLHVDQUF1QztBQUN2QyxrREFBa0Q7QUFDbEQsc0NBQXNDO0FBQ3RDLFVBQVU7QUFDVix1R0FBdUc7QUFFdkcsT0FBTztBQUNQLEtBQUs7QUFFRSxNQUFNcUIsU0FBUztJQUNwQkMsU0FBUztBQUNYLEVBQUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9tdXNrYW4vRG9jdW1lbnRzL3dlbGxuZXgtc2lnbnVwL21pZGRsZXdhcmUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgdHlwZSB7IE5leHRSZXF1ZXN0IH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5cbi8vIERlZmluZSBwdWJsaWMgcm91dGVzIHRoYXQgZG9uJ3QgcmVxdWlyZSBhdXRoZW50aWNhdGlvblxuY29uc3QgcHVibGljUm91dGVzID0gWycvbGFuZGluZycsICcvZmFxcycsICcvc2lnbmluJywgJy9zaWdudXAnLCAnL29uYm9hcmRpbmcvc3RlcC0xJywgJy9vbmJvYXJkaW5nL3N0ZXAtMicsICcvb25ib2FyZGluZy9zdGVwLTMnLCAnL29uYm9hcmRpbmcvc3RlcC00JywgJy9vbmJvYXJkaW5nL3N0ZXAtNScsICcvb25ib2FyZGluZy9zdGVwLTYnLCdwb2xpY3ktcGFnZScsICcvYWJvdXQnLCAnL2hlbHAnLCAnL3ZlcmlmeUVtYWlsJywgJy9mb3Jnb3QtcGFzc3dvcmQnLCAnL2xvZ291dCcsJy9jYXJlZXJzJ11cblxuLy8gRGVmaW5lIHByb3RlY3RlZCByb3V0ZXMgdGhhdCByZXF1aXJlIGF1dGhlbnRpY2F0aW9uXG5jb25zdCBwcm90ZWN0ZWRSb3V0ZXMgPSBbXG4gICcvcGF5bWVudC9wbGFuU2VsZWN0aW9uJywgXG4gICcvcGF5bWVudC9jYXJkRGV0YWlscycsIFxuICAnL3BheW1lbnQvc3VjY2VzcycsIFxuICAnL3BheW1lbnQvbWV0aG9kU2xlY3Rpb24nLFxuICAnL3BheW1lbnQvY3VycmVuY3lTZWxlY3Rpb24nLFxuICAnL2Rhc2hib2FyZCcsXG4gICcvYWRtaW4vZGFzaGJvYXJkJ1xuXVxuXG5leHBvcnQgZnVuY3Rpb24gbWlkZGxld2FyZShyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCB1cmwgPSByZXF1ZXN0Lm5leHRVcmwuY2xvbmUoKVxuICBjb25zdCB7IHBhdGhuYW1lIH0gPSB1cmxcblxuICAvLyBHZXQgdGhlIHRva2VucyBmcm9tIGNvb2tpZXMgYW5kIGhlYWRlcnNcbiAgY29uc3QgYXV0aENvb2tpZSA9IHJlcXVlc3QuY29va2llcy5nZXQoJ2F1dGhvcml6YXRpb24nKT8udmFsdWVcbiAgY29uc3QgdG9rZW5Db29raWUgPSByZXF1ZXN0LmNvb2tpZXMuZ2V0KCd0b2tlbicpPy52YWx1ZVxuICBjb25zdCBhdXRoSGVhZGVyID0gcmVxdWVzdC5oZWFkZXJzLmdldCgnYXV0aG9yaXphdGlvbicpXG5cbiAgY29uc3QgdG9rZW4gPSB0b2tlbkNvb2tpZSB8fFxuICAgIChhdXRoSGVhZGVyPy5zdGFydHNXaXRoKCdCZWFyZXIgJykgPyBhdXRoSGVhZGVyLnNwbGl0KCcgJylbMV0gOiBudWxsKSB8fFxuICAgIChhdXRoQ29va2llPy5zdGFydHNXaXRoKCdCZWFyZXIgJykgPyBhdXRoQ29va2llLnNwbGl0KCcgJylbMV0gOiBudWxsKVxuY29uc29sZS5sb2codG9rZW4pO1xuXG4gIC8vIFNUUklDVCBEQVNIQk9BUkQgTE9DSyAtIENoZWNrIHRoaXMgRklSU1QsIGJlZm9yZSBBTlkgb3RoZXIgY2hlY2tzXG4gIGlmIChyZXF1ZXN0LmNvb2tpZXMuZ2V0KCdkYXNoYm9hcmRMb2NrJyk/LnZhbHVlID09PSAndHJ1ZScpIHtcbiAgICAvLyBPbmx5IGFsbG93IGRhc2hib2FyZCBhbmQgbG9nb3V0LCBibG9jayBFVkVSWVRISU5HIGVsc2VcbiAgICBpZiAocGF0aG5hbWUgIT09ICcvZGFzaGJvYXJkJyAmJiBwYXRobmFtZSAhPT0gJy9sb2dvdXQnKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJy9kYXNoYm9hcmQnLCByZXF1ZXN0LnVybCkpXG4gICAgfVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpXG4gIH1cblxuICAvLyBDaGVjayBpZiB0aGUgcm91dGUgaXMgcHVibGljXG4gIGNvbnN0IGlzUHVibGljUm91dGUgPSBwdWJsaWNSb3V0ZXMuc29tZShyb3V0ZSA9PiBwYXRobmFtZSA9PT0gcm91dGUgfHwgcGF0aG5hbWUuc3RhcnRzV2l0aChyb3V0ZSArICcvJykpXG5cbiAgLy8gSWYgaXQncyBhIHB1YmxpYyByb3V0ZSwgYWxsb3cgYWNjZXNzIGltbWVkaWF0ZWx5XG4gIGlmIChpc1B1YmxpY1JvdXRlKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KClcbiAgfVxuXG4gIC8vIENoZWNrIGlmIHRoZSByb3V0ZSBpcyBwcm90ZWN0ZWRcbiAgY29uc3QgaXNQcm90ZWN0ZWRSb3V0ZSA9IHByb3RlY3RlZFJvdXRlcy5zb21lKHJvdXRlID0+IHBhdGhuYW1lID09PSByb3V0ZSB8fCBwYXRobmFtZS5zdGFydHNXaXRoKHJvdXRlICsgJy8nKSlcblxuICAvLyBJZiBpdCdzIGEgcHJvdGVjdGVkIHJvdXRlIGFuZCB0aGVyZSdzIG5vIHRva2VuLCByZWRpcmVjdCB0byBzaWduaW5cbiAgaWYgKGlzUHJvdGVjdGVkUm91dGUgJiYgIXRva2VuKSB7XG4gICAgY29uc3QgdXJsID0gbmV3IFVSTCgnL3NpZ25pbicsIHJlcXVlc3QudXJsKVxuICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KCdmcm9tJywgcGF0aG5hbWUpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdCh1cmwpXG4gIH1cblxuICAvLyBJZiBhdXRoZW50aWNhdGVkIGFuZCBvbiBkYXNoYm9hcmQsIHNldCBzdHJpY3QgbG9ja1xuICBpZiAocGF0aG5hbWUgPT09ICcvZGFzaGJvYXJkJyAmJiB0b2tlbikge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gTmV4dFJlc3BvbnNlLm5leHQoKVxuICAgIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdDYWNoZS1Db250cm9sJywgJ25vLXN0b3JlLCBuby1jYWNoZSwgbXVzdC1yZXZhbGlkYXRlLCBwcm94eS1yZXZhbGlkYXRlJylcbiAgICByZXNwb25zZS5oZWFkZXJzLnNldCgnUHJhZ21hJywgJ25vLWNhY2hlJylcbiAgICByZXNwb25zZS5oZWFkZXJzLnNldCgnRXhwaXJlcycsICcwJylcbiAgICByZXNwb25zZS5jb29raWVzLnNldCgnZGFzaGJvYXJkTG9jaycsICd0cnVlJywgeyBwYXRoOiAnLycgfSlcbiAgICByZXR1cm4gcmVzcG9uc2VcbiAgfVxuXG4gIC8vIElmIGF1dGhlbnRpY2F0ZWQgYW5kIG9uIGFkbWluIGRhc2hib2FyZCwgc2V0IHN0cmljdCBsb2NrXG4gIGlmIChwYXRobmFtZSA9PT0gJy9hZG1pbi9kYXNoYm9hcmQnICYmIHRva2VuKSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBOZXh0UmVzcG9uc2UubmV4dCgpXG4gICAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0NhY2hlLUNvbnRyb2wnLCAnbm8tc3RvcmUsIG5vLWNhY2hlLCBtdXN0LXJldmFsaWRhdGUsIHByb3h5LXJldmFsaWRhdGUnKVxuICAgIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdQcmFnbWEnLCAnbm8tY2FjaGUnKVxuICAgIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdFeHBpcmVzJywgJzAnKVxuICAgIHJlc3BvbnNlLmNvb2tpZXMuc2V0KCdhZG1pbkRhc2hib2FyZExvY2snLCAndHJ1ZScsIHsgcGF0aDogJy8nIH0pXG4gICAgcmV0dXJuIHJlc3BvbnNlXG4gIH1cblxuICAvLyBJZiBhZG1pbiBkYXNoYm9hcmQgbG9jayBpcyBzZXQsIG9ubHkgYWxsb3cgYWRtaW4gZGFzaGJvYXJkIGFuZCBsb2dvdXRcbiAgaWYgKHJlcXVlc3QuY29va2llcy5nZXQoJ2FkbWluRGFzaGJvYXJkTG9jaycpPy52YWx1ZSA9PT0gJ3RydWUnKSB7XG4gICAgaWYgKHBhdGhuYW1lICE9PSAnL2FkbWluL2Rhc2hib2FyZCcgJiYgcGF0aG5hbWUgIT09ICcvbG9nb3V0Jykge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvYWRtaW4vZGFzaGJvYXJkJywgcmVxdWVzdC51cmwpKVxuICAgIH1cbiAgfVxuXG4gIC8vIEhhbmRsZSBsb2dvdXRcbiAgaWYgKHBhdGhuYW1lID09PSAnL2xvZ291dCcpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvc2lnbnVwJywgcmVxdWVzdC51cmwpKVxuICAgIFxuICAgIC8vIENsZWFyIGFsbCBjb29raWVzXG4gICAgY29uc3QgY29va2llcyA9IHJlcXVlc3QuY29va2llcy5nZXRBbGwoKVxuICAgIGNvb2tpZXMuZm9yRWFjaChjb29raWUgPT4ge1xuICAgICAgcmVzcG9uc2UuY29va2llcy5kZWxldGUoY29va2llLm5hbWUpXG4gICAgfSlcbiAgICBcbiAgICAvLyBDbGVhciBzcGVjaWZpYyBpbXBvcnRhbnQgY29va2llc1xuICAgIHJlc3BvbnNlLmNvb2tpZXMuZGVsZXRlKCdvbmJvYXJkaW5nVG9rZW4nKVxuICAgIHJlc3BvbnNlLmNvb2tpZXMuZGVsZXRlKCd0b2tlbicpXG4gICAgcmVzcG9uc2UuY29va2llcy5kZWxldGUoJ2F1dGhvcml6YXRpb24nKVxuICAgIHJlc3BvbnNlLmNvb2tpZXMuZGVsZXRlKCdhZG1pbkRhc2hib2FyZExvY2snKVxuICAgIHJlc3BvbnNlLmNvb2tpZXMuZGVsZXRlKCdkYXNoYm9hcmRMb2NrJylcbiAgICByZXR1cm4gcmVzcG9uc2VcbiAgfVxuXG4gIC8vIFJlZGlyZWN0IC9sYWRpbmcgdG8gL2xhbmRpbmcgKHR5cG8gZml4KVxuICBpZiAocGF0aG5hbWUgPT09ICcvJykge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL2xhbmRpbmcnLCByZXF1ZXN0LnVybCkpO1xuICB9XG5cbiAgLy8gSGFuZGxlIHZlcmlmaWNhdGlvbiBVUkwgcmVkaXJlY3RcbiAgaWYgKHBhdGhuYW1lID09PSAnL3NpZ25pbicgJiYgdXJsLmhhc2guaW5jbHVkZXMoJ3ZlcmlmeUVtYWlsJykpIHtcbiAgICAvLyBFeHRyYWN0IGJ1c2luZXNzSWQgYW5kIHRva2VuIGZyb20gaGFzaFxuICAgIGNvbnN0IGhhc2hQYXJ0cyA9IHVybC5oYXNoLnNwbGl0KCcvJylcbiAgICBjb25zdCBidXNpbmVzc0lkID0gaGFzaFBhcnRzW2hhc2hQYXJ0cy5sZW5ndGggLSAxXS5zcGxpdCgnPycpWzBdXG4gICAgY29uc3QgdG9rZW4gPSB1cmwuaGFzaC5zcGxpdCgndG9rZW49JylbMV1cblxuICAgIC8vIFJlZGlyZWN0IHRvIHZlcmlmaWNhdGlvbiBwYWdlXG4gICAgdXJsLnBhdGhuYW1lID0gYC92ZXJpZnlFbWFpbC8ke2J1c2luZXNzSWR9YFxuICAgIHVybC5zZWFyY2ggPSBgP3Rva2VuPSR7dG9rZW59YFxuICAgIHVybC5oYXNoID0gJydcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QodXJsKVxuICB9XG5cbiAgLy8gU3RvcmUgY3VycmVudCBzdGVwIGluIGNvb2tpZSB3aGVuIG9uIG9uYm9hcmRpbmdcbiAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9vbmJvYXJkaW5nL3N0ZXAtJykpIHtcbiAgICBjb25zdCBjdXJyZW50U3RlcCA9IHBhdGhuYW1lLnNwbGl0KCdzdGVwLScpWzFdXG4gICAgY29uc3QgcmVzcG9uc2UgPSBOZXh0UmVzcG9uc2UubmV4dCgpXG4gICAgcmVzcG9uc2UuY29va2llcy5zZXQoJ2N1cnJlbnRTdGVwJywgY3VycmVudFN0ZXAgfHwgJzEnLCB7IHBhdGg6ICcvJyB9KVxuICAgIHJlc3BvbnNlLmNvb2tpZXMuc2V0KCdpbk9uYm9hcmRpbmcnLCAndHJ1ZScsIHsgcGF0aDogJy8nIH0pXG4gICAgcmV0dXJuIHJlc3BvbnNlXG4gIH1cblxuICAvLyBJZiB0cnlpbmcgdG8gYWNjZXNzIGRhc2hib2FyZCB3aGlsZSBvbiBvbmJvYXJkaW5nLCBrZWVwIHRoZW0gb24gY3VycmVudCBzdGVwXG4gIGlmIChwYXRobmFtZSA9PT0gJy9kYXNoYm9hcmQnICYmIHJlcXVlc3QuY29va2llcy5nZXQoJ2luT25ib2FyZGluZycpPy52YWx1ZSA9PT0gJ3RydWUnKSB7XG4gICAgY29uc3QgY3VycmVudFN0ZXAgPSByZXF1ZXN0LmNvb2tpZXMuZ2V0KCdjdXJyZW50U3RlcCcpPy52YWx1ZSB8fCAnMSdcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoYC9vbmJvYXJkaW5nL3N0ZXAtJHtjdXJyZW50U3RlcH1gLCByZXF1ZXN0LnVybCkpXG4gIH1cblxuICAvLyBDbGVhciBvbmJvYXJkaW5nIGNvb2tpZXMgd2hlbiBub3QgaW4gb25ib2FyZGluZ1xuICBpZiAoIXBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9vbmJvYXJkaW5nLycpKSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBOZXh0UmVzcG9uc2UubmV4dCgpXG4gICAgcmVzcG9uc2UuY29va2llcy5kZWxldGUoJ2luT25ib2FyZGluZycpXG4gICAgcmVzcG9uc2UuY29va2llcy5kZWxldGUoJ2N1cnJlbnRTdGVwJylcbiAgICByZXR1cm4gcmVzcG9uc2VcbiAgfVxuXG4gIC8vIElmIHRoZXJlJ3MgYSB0b2tlbiwgYWxsb3cgYWNjZXNzXG4gIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpXG59XG5cbi8vIENvbmZpZ3VyZSB3aGljaCByb3V0ZXMgdG8gcnVuIG1pZGRsZXdhcmUgb25cbi8vIGV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4vLyAgIG1hdGNoZXI6IFtcbi8vICAgICAvKlxuLy8gICAgICAqIE1hdGNoIGFsbCByZXF1ZXN0IHBhdGhzIGV4Y2VwdCBmb3IgdGhlIG9uZXMgc3RhcnRpbmcgd2l0aDpcbi8vICAgICAgKiAtIGFwaSAoQVBJIHJvdXRlcylcbi8vICAgICAgKiAtIF9uZXh0L3N0YXRpYyAoc3RhdGljIGZpbGVzKVxuLy8gICAgICAqIC0gX25leHQvaW1hZ2UgKGltYWdlIG9wdGltaXphdGlvbiBmaWxlcylcbi8vICAgICAgKiAtIGZhdmljb24uaWNvIChmYXZpY29uIGZpbGUpXG4vLyAgICAgICovXG4vLyAgICAgJy8oKD8hYXBpfF9uZXh0L3N0YXRpY3xfbmV4dC9pbWFnZXxmYXZpY29uLmljb3wuKlxcXFwuKHBuZ3xqcGd8anBlZ3xnaWZ8d2VicHxzdmd8aWNvfGNzc3xqcykpLiopJyxcblxuLy8gICBdLFxuLy8gfSBcblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgbWF0Y2hlcjogJy8oKD8hYXBpfF9uZXh0L3N0YXRpY3xfbmV4dC9pbWFnZXxmYXZpY29uLmljb3wuKlxcXFwuKD86cG5nfGpwZ3xqcGVnfGdpZnx3ZWJwfHN2Z3xpY298Y3NzfGpzKSkuKiknLFxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJwdWJsaWNSb3V0ZXMiLCJwcm90ZWN0ZWRSb3V0ZXMiLCJtaWRkbGV3YXJlIiwicmVxdWVzdCIsInVybCIsIm5leHRVcmwiLCJjbG9uZSIsInBhdGhuYW1lIiwiYXV0aENvb2tpZSIsImNvb2tpZXMiLCJnZXQiLCJ2YWx1ZSIsInRva2VuQ29va2llIiwiYXV0aEhlYWRlciIsImhlYWRlcnMiLCJ0b2tlbiIsInN0YXJ0c1dpdGgiLCJzcGxpdCIsImNvbnNvbGUiLCJsb2ciLCJyZWRpcmVjdCIsIlVSTCIsIm5leHQiLCJpc1B1YmxpY1JvdXRlIiwic29tZSIsInJvdXRlIiwiaXNQcm90ZWN0ZWRSb3V0ZSIsInNlYXJjaFBhcmFtcyIsInNldCIsInJlc3BvbnNlIiwicGF0aCIsImdldEFsbCIsImZvckVhY2giLCJjb29raWUiLCJkZWxldGUiLCJuYW1lIiwiaGFzaCIsImluY2x1ZGVzIiwiaGFzaFBhcnRzIiwiYnVzaW5lc3NJZCIsImxlbmd0aCIsInNlYXJjaCIsImN1cnJlbnRTdGVwIiwiY29uZmlnIiwibWF0Y2hlciJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./middleware.ts\n");

/***/ })

});